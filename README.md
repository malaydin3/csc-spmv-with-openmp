# Parallel Sparse Matrix-Vector Multiplication

This project implements parallel sparse matrix-vector multiplication using the Compressed Sparse Column (CSC) format with OpenMP. It includes three different implementations:
1. Serial implementation
2. Naive parallel implementation
3. Column grouping-based parallel implementation

## Prerequisites

- C++ compiler with OpenMP support (e.g., Clang on macOS)
- CMake (version 3.10 or higher)
- Homebrew (for macOS users)

### macOS Setup
```bash
# Install required packages
brew install libomp cmake
```

## Building the Project

```bash
# Clone the repository
git clone https://github.com/malaydin3/csc-spmv-with-openmp.git
cd csc-spmv-with-openmp

# Configure and build
cmake -B build
cd build
make ${nproc}
```

## Running the Project

```bash
cd bin
./csc_spmv.out
```

## Input Format

The program expects four input files:
- `row_indices.txt`: Row indices of non-zero elements
- `col_indices.txt`: Column indices of non-zero elements
- `values.txt`: Values of non-zero elements
- `dims.txt`: Matrix dimensions (rows columns)
- `vec.txt`: Dense vector for multiplication
which could be generated by the utils scripts under `utils/coo_matrix_generator.py`

## Implementation Details

### 1. Matrix Formats
- **COO (Coordinate)**: Initial sparse matrix format
- **CSC (Compressed Sparse Column)**: Optimized format for computation

### 2. Parallel Implementations
- **Naive Parallel**: Direct OpenMP parallelization with atomic operations
- **Column Grouping**: Advanced parallel implementation using column coloring to avoid race conditions

### 3. Key Features
- Template-based implementation supporting different numeric types
- Automatic column coloring for parallel execution
- Performance timing measurements
- Verification of results between implementations

## Usage Example

```cpp
// Create matrix and vector objects
COO_Matrix<double> matrixCOO(rowFile, colFile, valsFile, dimsFile);
CSC_Matrix<double> matrix_CSC(matrixCOO);
vector<double> vec = parseDenseVector<double>(vecFile);

// Perform multiplications
vector<double> result_serial = matrix_CSC.serialVecMatMultiplication(vec);
vector<double> result_parallel = matrix_CSC.parallelVecMatMultiplicationNaive(vec);
vector<double> result_grouped = matrix_CSC.parallelVecMatMultiplicationGrouping(vec);
```

## Performance Verification

The implementation includes automatic verification:
- Compares sums of result vectors
- Computes L2-norm of differences between implementations
- Reports execution time for each method
